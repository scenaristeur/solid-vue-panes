{"version":3,"sources":["webpack:///./src/components/chat/SolidChatSend.vue?d9a8","webpack:///./src/components/chat/SolidChatSend.vue?bb45","webpack:///src/components/chat/SolidChatSend.vue","webpack:///./src/components/chat/SolidChatSend.vue?2826","webpack:///./src/components/chat/SolidChatSend.vue?9b3d"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","webId","attrs","on","$event","type","indexOf","_k","keyCode","key","send","model","value","callback","$$v","message","expression","_v","staticRenderFns","console","log","name","components","data","computed","fileUrl","$store","state","solid","watch","methods","component"],"mappings":"gHAAA,W,kECAA,IAAIA,EAAS,WAAa,IAAIC,EAAIC,KAASC,EAAGF,EAAIG,eAAmBC,EAAGJ,EAAIK,MAAMD,IAAIF,EAAG,OAAOE,EAAG,MAAM,CAACE,YAAY,mBAAmB,CAAe,MAAbN,EAAIO,MAAeH,EAAG,gBAAgB,CAACE,YAAY,SAASE,MAAM,CAAC,KAAO,OAAO,CAACJ,EAAG,eAAe,CAACK,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAIA,EAAOC,KAAKC,QAAQ,QAAQZ,EAAIa,GAAGH,EAAOI,QAAQ,QAAQ,GAAGJ,EAAOK,IAAI,SAAkB,KAAcf,EAAIgB,KAAKN,KAAUO,MAAM,CAACC,MAAOlB,EAAW,QAAEmB,SAAS,SAAUC,GAAMpB,EAAIqB,QAAQD,GAAKE,WAAW,aAAalB,EAAG,uBAAuB,CAACA,EAAG,WAAW,CAACI,MAAM,CAAC,QAAU,WAAWC,GAAG,CAAC,MAAQT,EAAIgB,OAAO,CAAChB,EAAIuB,GAAG,WAAW,IAAI,GAAGnB,EAAG,mBAAmB,CAACE,YAAY,gBAAgB,IAC/oBkB,EAAkB,G,sGCqBtB,Y,EAAA,UAGA,eACA,eACAC,QAAQC,IAAI,QAAZ,GAGA,OACEC,KAAM,gBACNC,WAAF,CACI,iBAAoB,WAAxB,yDAGEC,KAAM,WACJ,MAAO,CACLR,QAAS,KAgBbS,SAAF,CACIC,QAAS,WACP,OAAO,KAAb,2BAEIxB,MAJJ,WAKM,OAAON,KAAK+B,OAAOC,MAAMC,MAAM3B,QAGnC4B,MAAF,CACI5B,MADJ,SACA,GACMkB,QAAQC,IAAI,QAAlB,IAEI,QAJJ,WAIA,wKACA,wBADA,iDAEA,uCACA,kBACA,iCAEA,gEANA,6BAQA,oCARA,+CAaEU,QAAS,CACP,KADJ,WACA,iLAGA,6BACA,2BAEA,yBACA,6BAPA,wBAQA,uBACA,WACA,oBACA,kBAKA,0DAIA,sBACA,wEACA,kBACA,eAvBA,UA0BA,iFA1BA,yBA4BA,0BA5BA,eA4BA,EA5BA,OA6BA,+BACA,uCACA,+BACA,6BAhCA,UAqCA,SArCA,QAqDA,aArDA,wBAuDA,qDAvDA,iDChFsW,I,wBCQlWC,EAAY,eACd,EACAtC,EACAyB,GACA,EACA,KACA,WACA,MAIa,aAAAa,E","file":"js/chunk-b104131c.44d5b8ce.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SolidChatSend.vue?vue&type=style&index=0&id=0533eae2&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"solid-chat-send\"},[(_vm.webId != null)?_c('b-input-group',{staticClass:\" input\",attrs:{\"size\":\"lg\"}},[_c('b-form-input',{on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.send($event)}},model:{value:(_vm.message),callback:function ($$v) {_vm.message=$$v},expression:\"message\"}}),_c('b-input-group-append',[_c('b-button',{attrs:{\"variant\":\"warning\"},on:{\"click\":_vm.send}},[_vm._v(\"Send\")])],1)],1):_c('SolidLoginButton',{staticClass:\"mt-3 input\"})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"solid-chat-send\">\r\n    <!--<h1>Room name</h1> -->\r\n\r\n\r\n    <b-input-group class=\" input\" v-if=\"webId != null\" size=\"lg\" >\r\n      <b-form-input v-model=\"message\" v-on:keyup.enter=\"send\"></b-form-input>\r\n      <b-input-group-append>\r\n        <!--  <b-button variant=\"outline-success\">Button</b-button>-->\r\n        <b-button variant=\"warning\" @click=\"send\" >Send</b-button>\r\n      </b-input-group-append>\r\n    </b-input-group>\r\n    <SolidLoginButton class=\"mt-3 input\" v-else />\r\n\r\n\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { fetchDocument } from 'tripledoc';\r\nimport { sioc, dct, foaf } from 'rdf-namespaces' //\r\nconst { namedNode } = require('@rdfjs/data-model');\r\nimport auth from 'solid-auth-client';\r\nimport FC from 'solid-file-client'\r\nconst fc = new FC( auth )\r\nlet solid = window.solid\r\nconsole.log(\"SOLID\",solid)\r\n\r\n\r\nexport default {\r\n  name: 'SolidChatSend',\r\n  components:{\r\n    'SolidLoginButton': () => import('@/components/solid/SolidLoginButton')\r\n\r\n  },\r\n  data: function () {\r\n    return {\r\n      message: \"\",\r\n    }\r\n  },\r\n  /*async created(){\r\n\r\n    if( !await fc.itemExists( this.fileUrl )) {\r\n      await fc.postFile(this.fileUrl, \"\", \"text/turtle\")\r\n      .then((content) => {\r\n        console.log(\"File Created\",content)\r\n      })\r\n      .catch(err => console.error(`Error: ${err}`))\r\n    }else{\r\n      console.log(\"File exist\",this.fileUrl)\r\n    }\r\n  },*/\r\n\r\n  computed:{\r\n    fileUrl: function(){\r\n      return  this.$store.state.chat.fileUrl\r\n    },\r\n    webId(){\r\n      return this.$store.state.solid.webId\r\n    }\r\n  },\r\n  watch:{\r\n    webId(webId){\r\n      console.log(\"Webid\",webId)\r\n    },\r\n    async  fileUrl(){\r\n      if( !await fc.itemExists( this.fileUrl )) {\r\n        await fc.postFile(this.fileUrl, \"\", \"text/turtle\")\r\n        .then((content) => {\r\n          console.log(\"File Created\",content)\r\n        })\r\n        .catch(err => console.error(`Error: ${err}`))\r\n      }else{\r\n        console.log(\"File exist\",this.fileUrl)\r\n      }\r\n    }\r\n\r\n  },\r\n  methods: {\r\n    async send(){\r\n      // please refer to https://github.com/scenaristeur/shighl/blob/9b4b61d06d8a20f55de3f2aa580cbc5fb840d584/src/Shighl-chat.js#L214\r\n      // and https://github.com/LDflex/LDflex/issues/53\r\n      let webId= this.$store.state.solid.webId\r\n      let root= this.$store.state.chat.root\r\n\r\n      console.log(this.fileUrl)\r\n      if (this.message.length > 0 && webId != null)    {\r\n        console.log(this.message)\r\n        var dateObj = new Date();\r\n        var messageId = \"Msg\"+dateObj.getTime()\r\n        var date = dateObj.toISOString()\r\n        //    let msgUrl = this.fileUrl+messageId\r\n        /*  console.log(msgUrl)\r\n        await solid.data[msgUrl].dct$created.add(date)\r\n        await solid.data[msgUrl].sioc$content.add(this.message)*/\r\n        console.log(\"WEBID\",this.$store.state.solid.webId, this.fileUrl)\r\n\r\n        //let index = \"this\"\r\n        //  let ind_prefix = \"../../../index.ttl#\" //\" root+\"/index.ttl#\"\r\n        let index = root+\"/index.ttl#this\"\r\n        console.log(\"TODO : must integrate \"+index+\" in tripledoc or batch ldflex\")\r\n        let messUri = this.fileUrl+\"#\"+messageId\r\n        console.log(messUri)\r\n\r\n\r\n        await solid.data.from(this.fileUrl)[index]['http://www.w3.org/2005/01/wf/flow#message'].add(namedNode(messUri))\r\n\r\n        const chatDoc = await fetchDocument(this.fileUrl);\r\n        let subj =   chatDoc.addSubject({identifier:messageId})\r\n        subj.addLiteral(sioc.content, this.message)\r\n        subj.addLiteral(dct.created, date)\r\n        subj.addNodeRef(foaf.maker, webId)\r\n\r\n        /*  let indexSubj = chatDoc.addSubject({identifier: index, identifierPrefix: ind_prefix})\r\n        indexSubj.addNodeRef('http://www.w3.org/2005/01/wf/flow#message',subj.asNodeRef())*/\r\n\r\n        await chatDoc.save();\r\n\r\n\r\n        //  await solid.data.from(this.fileUrl)[index]['http://www.w3.org/2005/01/wf/flow#message'].add(namedNode(messUri))\r\n        //    console.log(namedNode)\r\n        //          await solid.data.from(this.fileUrl)[index]['http://www.w3.org/2005/01/wf/flow#message'].set(namedNode(subj.asRef()))\r\n\r\n        /*\r\n        const chatDoc2 = await fetchDocument(this.fileUrl);\r\n        let index =   chatDoc2.addSubject({identifier:this.root+\"/index.ttl\"})\r\n        console.log(await index.getTriples())\r\n        console.log(await index.getRef())\r\n        index.addNodeRef('http://www.w3.org/2005/01/wf/flow#message', subj)\r\n        //https://solidarity.inrupt.net/public/ChatTest/index.ttl#this\r\n        await chatDoc2.save();*/\r\n\r\n        this.message=\"\"\r\n      }else{\r\n        alert ( \"Oh Oh, if yu wanna post yu gotta log in ;-)\")\r\n      }\r\n      //  await solid.data[msgUrl].foaf$maker.add(namedNode('https://www.test.com')) // namedNode(`${webid}`)\r\n      //  await solid.data.from(this.url)[messageId]['http://www.w3.org/2005/01/wf/flow#message'].add(this.url)\r\n      //this.message = \"\"\r\n      //  await solid.data.from(this.url)[this.subject]['http://www.w3.org/2005/01/wf/flow#message'].add(namedNode(this.url))\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\r\n<style scoped>\r\n.input {\r\n  position: fixed;\r\n  bottom:0;\r\n  z-index: 999;\r\n  width: 100%;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SolidChatSend.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./SolidChatSend.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./SolidChatSend.vue?vue&type=template&id=0533eae2&scoped=true&\"\nimport script from \"./SolidChatSend.vue?vue&type=script&lang=js&\"\nexport * from \"./SolidChatSend.vue?vue&type=script&lang=js&\"\nimport style0 from \"./SolidChatSend.vue?vue&type=style&index=0&id=0533eae2&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0533eae2\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}